# InferenciaBayesianaCausal1

## Materia `Inferencia Bayesiana Causal 1`. (IBC1.2024.2)

La materia `Inferencia Bayesiana Causal 1` (2024, segundo semestre) se imparte como materia optativa de forma paralela en las licenciaturas de ciencias de datos de la Escuela de Ciencia y Tecnoliogía de la UNSAM y en las licenciatura de ciencia de datos, ciencias de la computación y posgrado de Facultad de Ciencias Exactas y Naturales, UBA.

<br>

<table>
  <tr>
    <td width="50%" align="center"><img src="auxiliar/static/ecyt.jpeg" width="250"/></td>
    <td width="50%" align="center"><img src="auxiliar/static/UNSAM_blanco.png" width="250"/></td>
  </tr>
  <tr>
    <td width="50%" align="center"><b>Campus Migueletes - EscuelaCyT</b></td>
    <td width="50%" align="center"><b>Universidad Nacional de San Martín - Argentina</b></td>
  </tr>
</table>

  <br>

<table>
  <tr>
    <td width="50%" align="center"><img src="auxiliar/static/fcen.png" width="250"/></td>
    <td width="50%" align="center"><img src="auxiliar/static/UBA2_blanco.jpg" width="250"/></td>
  </tr>
  <tr>
    <td width="50%" align="center"><b>Pabellón 0 + Inf - FacultadCEN</b></td>
    <td width="50%" align="center"><b>Universidad Nacional de Buenos Aires - Argentina</b></td>
  </tr>
</table>

### Marco Conceptual: ¿Qué (inter)acción genera tu bienestar?.

<em>Las propiedades de los sistemas naturales emergen de la <b>interacción</b> entre los elementos que los componen</em>.
La palabra átomo proviene de los vocablos griegos $\alpha (sin) y $\tau\omega\mu\omega\nu$ (tomon o corte) y significa indivisible.
Sin embargo, hoy sabemos que los átomos están compuestos de electrones, protones y neutrones.
El electrón es la partícula más liviana de un átomo y se ignora si poseé una estructura interna, por lo que se considera una partícula elemental.



Las interacciones entre electrones, protones y neutrones produce diversos tipos de átomos.



<table>
  <tr>
    <td width="50%" align="center"><img src="auxiliar/download/atomo_de_oxigeno.png" width="250"/></td>
   </tr>
  <tr>
    <td width="50%" align="center"><b>Átomo de oxígeno</b></td>
  </tr>
</table>



Las interacciones entre átomos produce diversas moléculas.
Hay solo $118$ átomos conocidos hasta la actualidad, pero hay una enorme diversidad de int


Las propiedades de la molécula $H_20$ son emergentes de un tipo de <em>interacción</em> entre las átomos de oxígeno $O$ e hidrógeno $H$, y las propiedades del agua son emergentes de la <em>interacción</em> entre moléculas $H_20$.

Las propiedades de las moléculas de tipo ARN,

Las propiedades de un organismo vivo, una sociedad o un ecosistema también emergen de la <em>interacción</em> entre los elementos de la materia que la componen.
La interacción que llamamos "agua" nace y muere durante procesos químicos, como por ejemplo los que ocurren durante la combustión.
En particular, la electrólisis del agua transforma el agua líquida ($2 \cdot H_2O$) en hidrógeno y oxígenos gaseosos ($H_2 + O_2$): en el electrodo negativo $2 \cdot H_2O+ 2e^{−} \rightarrow  H_2 + 2\cdot OH^{−} $, y en el positivo $4OH^{−} \rightarrow O_2​ + 2\cdot H_2​O + 4e^{−}$.
A la inversa, la combustión de hidrógeno y oxígeno gaseosos produce agua y energía (calor o luz), $ 2\cdot H_2​ + O_2​ \rightarrow 2H2​O(g) + \text{energía}$.

<br>

Si bien el agua "nace" y "muere", no decimos que el agua sea una forma de vida pues ella no se reproduce.
Existe menos controversia en considerar a los virus, fragmentos de ARN, como formas vida por su indiscutible capacidad de sobrevivir, reproducirse y diversificarse en el tiempo, adaptándonse a los cambios ambientales que ocurren en su entorno, como el sistema inmune del ser humano.
Los organismos vivos, a diferencia de los objetos físico y químicos, enfrentan el problema de control del <em>ciclo de intercambios acción-percepción</em> con la naturaleza del cual depende para sobrevivir y reproducirse.
Este problema real se traduce en un problema de conocimiento: ¿qué formas alternativas de la materia producen ciclos de acción-percepción con la naturaleza que mejoran su supervivencia y reproducción?

<br>

Ante todo, los organismos vivos deben transmitir y actualizar en el tiempo su conocimiento teleológico para intervenir en su favor el ciclo de acción-percepción con la naturaleza.
Desde el surgimiento de la primera forma de la materia capaz de reproducirse, hasta el presente, las formas alternativas de la materia se expanden y contraen siguiendo una secuencia de tasas de supervivencia y reproducción.


la vida adquirió una extraordinaria complejidad en términos de diversificación, cooperación, especialización y heterogeneidad.




La biomasa en la tierra es, en este sentido, el estado del conocimientos causales conocida en el entorno del planeta tierra con probadas capacidades para sobrevivir, para reproducirse o expandirse, y para modificarse o explorar nuevos espacios alternativos de formas de la materia.


Los organismos vivos codifican este conocimiento







Desde el surgimiento de la primera forma de la materia capaz de reproducirse hasta el presente, la vida adquirió una extraordinaria complejidad en términos de diversificación, cooperación, especialización y heterogeneidad.
















Actualmente, las formas de vida más "simples" (virus, protozoa, archaea y bacterias) representan el 16\% de la biomasa en la tierra, las formas de vida compleja que se alimentan del sol, agua y otro componentes químicos (las plantas) representan el 82\%, y las formas de vida que necesitan alimentarse de otros seres (hongos y animales) representan el 2\%.

<br>





A diferencia de otros animales, el linaje humano comenzó a heredar conocimientos prácticos no solo en forma de información genética, sino también en forma de información cultural (tradiciones cognitivas o comportamentales).
Antes de la transición cultural estuvimos en grave peligro de extinción, como se evidencia en la baja diversidad del genoma humano respecto de nuestros homínidos más cercanos\cite{Hrdy2009}.
Luego de la transición cultural ocupamos todos los nichos ecológicos de la tierra como ningún otro vertebrado terrestre lo había logrado antes~\cite{Boyd2011}.
A pesar de este relativo éxito evolutivo, la biomasa humana representa tan solo el $0.01$\% de la biomasa total (o $2.5$\% de la biomasa animal) y las proyecciones indican que estamos a menos de un siglo del estancamiento.






Desde el surgimiento de la primera forma de vida capaz de auto-reproducirse, hace 4 mil millones de años, hasta la actualidad, la vida adquirió una enorme complejidad en términos de diversificación, cooperación, especialización y heterogeneidad. El





## Objetivos.

Esta materia está enfocada en la evaluación de argumentos causales alternativos mediante la (aproximación a) la aplicación estricta de las reglas de la probabilidad, el sistema de razonamiento en contextos de incertidumbre. La materia Inferencia Bayesiana Causal 1 tiene por principal objetivo revisar los métodos desarrollados en las últimas décadas para:

    Especificar matemáticamente los argumentos causales expresados en lenguaje natural mediante métodos gráficos intuitivos
    Precisar cómo la estructura causal influye en el flujo de inferencia entre las variables del modelo.
    Identificar el efecto causal entre variables de un modelo causal en base a datos observacionales.
    Diseñar experimentos que permitan evaluar modelos causales alternativos
    Tomar decisiones óptimas en contextos de incertidumbre.



Unidad 1. Introducción a la especificación y evaluación de argumentos causales

    Descripción y explicación. La estructura matemática del discurso descriptivo. Los generalizaciones empíricas y los enunciados teóricos. Aprendizaje basado en modelos. Distribuciones de creencias honestas

    Las reglas de razonamiento en contextos de incertidumbre: preservar la creencia previa que sigue siendo compatible con el dato y predecir con la contribución de todas las hipótesis. Métodos gráficos de especificación matemática de argumentos causales.

    Evaluación de modelos causales alternativios: generación de datos sintéticos y aplicación estricta de las reglas de la probabilidad. Ejemplos de modelos identificables y no identificables a partir de observaciones sin intervenciones.

    Bibliografía sugerida: Parr et al (1,2,3), Samaja (3.1-3.4), Klimovsky (4), Bishop [6] (1-4).

Unidad 2. Emergencia del overfitting por selección y el balance natural por evaluación

    Distribuciones conjugadas. Ejemplos varios. Caso en profundiad: regresión polinomial basada en la aplicación estricta de las reglas de la probabilidad. El problema computacional de la aplicación estricta de las reglas de la probabilidad.

    Aproximación de la inferencia mediante métodos de estimación puntal basados en funciones de costo ad-hoc: máxima verosimilitud, máximo a posteriori y validación cruzada. Efectos secundarios de la ruptura de las reglas de la probabildiad: el sobreajuste (overfitting).

    La ausencia de efectos indeseados en el sistema de razonamiento probabilístico: el balance natural mediante la evaluación completa del espacio de hipótesis. Ensambles de modelos. Procesos gaussianos.

    Bibliografía sugerida. Bishop [2] (1.1-1.3, 2.1-2.3, 3.3-3.4, 6.4.1-6.4.2)

Unidad 3. Sorpresa: el problema de la comunicación con la realidad

    Los niveles de la base empírica. La estructura invariante del dato científico y el lugar que ocupan los supuestos. El isomorfismo con los sistemas de información emisor-receptor de la teoría de la información.

    La natrualeza multiplicativa de la función de costo de la teoría de la probabilidad. Su rol en la construcción de sistemas de comunicación con la realidad. Analogías con las apuestas y la propiedad epistémica.

    Evaluación de sistemas de comunicación alternativos en base a su tasa de sorpresa. Ejemplos. Interpretación de entropía y entropía cruzada. Definición de “no mentir” como máxima entropía dadas las restricciones.

    Bibliografía sugerida: Klimovsky (2), Samaja (3.5, 3.6.2-5), MacKay (1.1, 2.4-6, 4.1). Kelly (paper).

Unidad 4. Especificación de teorías causales, flujo de inferencia.

    Método gráficos de especificación matemática de modelos causales probabilísticos mediante factor graphs. Análisis del flujo de inferencia mediante la descomposición de las reglas de la probabildiad como mensajes entre los nodos del grafo, sum-product algorithm.

    Las teorías causales como sistemas dinámicos de modelos causales que se prenden y apagan en función del contexto. Los conceptos de potential outcome y do-operator. Su especificación mediante gates.

    La paradoja de Yule-Simpson. Flujo de inferencia (independencia condicional) en las estructuras elementales: pipe, fork, collider. El criterio de d-separación. Los niveles de razonamiento causal: asociacional, intervencional, y contrafactual.

    Bibliografía sugerida. Winn (paper), Bishop (8.2-8.2.2, 8.4-8.4.4, 8.4.7). Neal (2.1, 3, 4.1), Pearl (1).

Unidad 5. Estimación de efecto causal.

    El efecto de las intervenciones: truncated factorization, inverse probability weighting, propensity scores. Estimación de efectos causales en datos no-experimentales mediante adjustment formula. Su generalización, g-computation algorithm formula.

    Métodos gráficos para predicción del contrafactual: twin networks. Métodos gráficos general para identificar el tipo de ajuste requerido: el backdoor criterion. Estimaciones no paramétricas: frontdoor criterior y do-calculus. Variables instrumentales y otros criterios.

    Ejemplo de estructuras causales y clasificación de variables como buenos, neutrales o malos para la identificación del efecto causal mediante backdoor criterion.

    Bibliografía sugerida. Pearl (3,6-7), Hernán (parte I), Cinelli (paper), Neal (4, 6, 7.5-7.6).

Unidad 6. Ciclos de acción-percepción: el problema de la interacción con la realidad

    El ciclo acción-percepción entre agente y ambiente: percepción (reward-signal), inferencia (hipótesis/modelos), predicción (objetivo) acción (política/intervención). Diferencia entre señal y reward.

    Especificación de objetivos como problemas de maximización de utilidad esperada de la intervenciones en el tiempo. La reformulación ergódica de la teoría de utilidad esperada. Especificación gráfica de rewards mediante diagramas de influencia: sequential backdoor criterion.

    Control óptimo en Partial Observed Markov Decision Process (POMDP). Ejemplos varios. Evaluación de de políticas de intervención.

    Bibliografía sugerida: Levine (1-2), Pearl (4), Peters (paper). Otras: Sutton-Barto (3), Koller (21).

Unidad 7. Métodos de evaluación de teorías causales

    La evaluación de modelos como un juego de interacción acción-percepción con la naturaleza. La naturaleza de la función costo para evaluación de modelos causales alternativos.

    Métodos de Monte Carlo para evaluar modelos: Bridge Sampling, thermodynamical integration, importance sampling.

    Ejemplos de evaluación de modelos causales a través de datos obtenidos por interacción con una simulador causal suyacente oculto. Evaluación de acciones (policies) alternativas. La emergencia de la estrategia falsacionisita como comportamiento óptimo.

    Bibliografía sugerida. Kass (paper), Pearl (7,9). Hernán (parte II) Otros: Vousden, Perrakis, Gronau.

Unidad 8. Inferencia causal en series temporales.

    Modelos de historia completa. Los problemas de usar el último posterior como prior del siguiente evento (enfoque de filtering). Algoritmo loopy belief propagation para la propagación de la información por toda la red histórica causal (enfoque de smoothing).

    State-space models. Evaluación del efecto causal en series temporales, contrafactuales. Intervenciones en series temporales. Métodos de monte carlo para series temporales: sequential importance resampling.

    Estimación de efecto causal por simulación de contrafctuales en series temporales. Evaluación de modelos causales alternativos. Apuestas óptimas en deportes: criterio Kelly, fractional Kelly.

    Bibliografía sugerida. Brodersen (paper), Dangauthier (paper), Bishop (13.2.3-13.2.4, 13.3), Hernán (parte II).

Unidad 9. Isomorfismo probabilidad-evolución y hackatón “apuestas de vida”.

    Isomorfismo entre las ecuaciones fundamentales de la teoría de la probabilidad (teorema de Bayes) y la teoría de la evoluición (replicator dynamic). La naturaleza multiplicativa de la función de costo epistemico-evolutivo.

    Las emergencia de las variantes que reducen las fluctuaciones por diversificación individual (propiedad epistémica), cooperación (propiedad evolutiva), especialización (propiedad de especiación), y heterogeneidad (propiedad ecológica).

    Presentación de una competencia de inferencia, intervención, apuestas e intercambios de recursos.

    Bibliografía sugerida. Peters (paper). Czegel (paper). Koller (23).


OBJETIVOS O PROPÓSITOS

    Dominio de los métodos de especificación matemática de argumentos causales expresados en lenguaje natural mediante redes bayesianas y factor graphs.

    Destreza para la identificación de los flujos de inferencia en cualquier estructura causal y de las condiciones necesarias para evaluar efectos causales en ausencia de intervenciones.

    Capacidad para diseñar experimentos que permitan evaluar modelos causales alternativos y aptitud para realizar la inferencia aproximando la aplicación estricta de las reglas de la probabilidad.

    Comprensión de los cíclos de acción-percepción y habilidad para seleccionar los comportamientos óptimos en problemas de toma de decisiones temporales.



BIBLIOGRAFÍA

    Pearl J. Causality. Cambridge university press; 2009.
    Parr T, Pezzulo G, Friston KJ. Active inference. MIT Press; 2022

SUGERIDA / COMPLEMENTARIA:

    Bishop. Model-based machine learning. Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences. 2013

    Bishop. Pattern recognition and machine learning. Springer; 2006

    Brodersen KH, Gallusser F, Koehler J, Remy N, Scott SL. Inferring causal impact using Bayesian structural time-series models. The Annals of Applied Statistics. 2015;

    Chopin N, Papaspiliopoulos O, et al. An introduction to sequential Monte Carlo. Vol. 4. Springer; 2020.

    Cinelli C, Forney A, Pearl J. A crash course in good and bad controls. Sociological Methods & Research. 2022

    Czégel D, Giaffar H, Tenenbaum JB, Szathmáry E. Bayes and Darwin: How replicator populations implement Bayesian computations. BioEssays. 2022.

    Dangauthier P, Herbrich R, Minka T, Graepel T. Trueskill through time: Revisiting the history of chess. In: Advances in Neural Information Processing Systems; 2008

    Gronau QF, Sarafoglou A, Matzke D, Ly A, Boehm U, Marsman M, et al. A tutorial on bridge sampling. Journal of mathematical psychology. 2017.

    Hernán MA, Robins JM. Causal inference: What if. 2020.

    Jaynes ET. Bayesian methods: General background; 1984.

    Kass RE, Raftery AE. Bayes factors. Journal of the american statistical association. 1995.

    Kelly jr JL. A New Interpretation of Information Rate. Bell System Technical Journal. 1956

    Klimovsky G. Las desventuras del conocimiento cientı́fico; 1994

    Koller D, Friedman N. Probabilistic graphical models: principles and techniques. MIT press; 2009.

    Levine S. Reinforcement learning and control as probabilistic inference: Tutorial and review. arXiv preprint arXiv:180500909. 2018.

    MacKay DJ. Information theory, inference and learning algorithms. Cambridge university press; 2003.

    McElreath R. Statistical rethinking: A Bayesian course with examples in R and Stan. 2020

    Martin OA, Kumar R, Lao J. Bayesian Modeling and Computation in Python. CRC Press; 2022.

    Neal. Introduction to causal inference. Course Lecture Notes (draft). 2020;

    Perrakis K, Ntzoufras I, Tsionas EG. On the use of marginal posteriors in marginal likelihood estimation via importance sampling. Computational Statistics & Data Analysis. 2014.

    Peters O. The ergodicity problem in economics. Nature Physics. 2019.

    Popper K. La lógica de la investigación cientı́fica; 1967.

    Samaja J. Epistemologı́a y metodologı́a: elementos para una teorı́a de la investigación cientı́fica. EUDEBA; 1999.

    Sutton RS, Barto AG. Reinforcement Learning: An Introduction. Second edition. MIT Press; 2018.

    Vousden W, Farr WM, Mandel I. Dynamic temperature selection for parallel tempering in Markov chain Monte Carlo simulations. Monthly Notices of the Royal Astronomical Society. 2016

    Winn J. Causality with gates. In: Artificial Intelligence and Statistics. PMLR; 2012.

